Search.setIndex({docnames:["README","api/modules","api/spnflow","api/spnflow.algorithms","api/spnflow.io","api/spnflow.learning","api/spnflow.learning.splitting","api/spnflow.optimization","api/spnflow.structure","api/spnflow.torch","api/spnflow.utils","index"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":1,sphinx:56},filenames:["README.md","api/modules.rst","api/spnflow.rst","api/spnflow.algorithms.rst","api/spnflow.io.rst","api/spnflow.learning.rst","api/spnflow.learning.splitting.rst","api/spnflow.optimization.rst","api/spnflow.structure.rst","api/spnflow.torch.rst","api/spnflow.utils.rst","index.rst"],objects:{"":{spnflow:[2,0,0,"-"]},"spnflow.algorithms":{evaluation:[3,0,0,"-"],inference:[3,0,0,"-"],mpe:[3,0,0,"-"],sampling:[3,0,0,"-"]},"spnflow.algorithms.evaluation":{eval_bottom_up:[3,1,1,""],eval_top_down:[3,1,1,""]},"spnflow.algorithms.inference":{leaf_likelihood:[3,1,1,""],leaf_log_likelihood:[3,1,1,""],likelihood:[3,1,1,""],log_likelihood:[3,1,1,""],node_likelihood:[3,1,1,""],node_log_likelihood:[3,1,1,""]},"spnflow.algorithms.mpe":{leaf_mpe:[3,1,1,""],mpe:[3,1,1,""],sum_mpe:[3,1,1,""]},"spnflow.algorithms.sampling":{leaf_sample:[3,1,1,""],sample:[3,1,1,""],sum_sample:[3,1,1,""]},"spnflow.io":{json:[4,0,0,"-"]},"spnflow.io.json":{json_obj_spn:[4,1,1,""],json_spn_obj:[4,1,1,""],load_json:[4,1,1,""],save_json:[4,1,1,""]},"spnflow.learning":{leaf:[5,0,0,"-"],splitting:[6,0,0,"-"],structure:[5,0,0,"-"],wrappers:[5,0,0,"-"]},"spnflow.learning.leaf":{get_learn_leaf_method:[5,1,1,""],learn_isotonic:[5,1,1,""],learn_mle:[5,1,1,""]},"spnflow.learning.splitting":{cols:[6,0,0,"-"],gmm:[6,0,0,"-"],kmeans:[6,0,0,"-"],random:[6,0,0,"-"],rdc:[6,0,0,"-"],rows:[6,0,0,"-"]},"spnflow.learning.splitting.cols":{get_split_cols_method:[6,1,1,""],split_cols_clusters:[6,1,1,""]},"spnflow.learning.splitting.gmm":{gmm:[6,1,1,""]},"spnflow.learning.splitting.kmeans":{kmeans:[6,1,1,""]},"spnflow.learning.splitting.random":{random_cols:[6,1,1,""],random_rows:[6,1,1,""]},"spnflow.learning.splitting.rdc":{rdc_cca:[6,1,1,""],rdc_cols:[6,1,1,""],rdc_rows:[6,1,1,""],rdc_transform:[6,1,1,""]},"spnflow.learning.splitting.rows":{get_split_rows_method:[6,1,1,""],split_rows_clusters:[6,1,1,""]},"spnflow.learning.structure":{Operation:[5,2,1,""],choose_next_operation:[5,1,1,""],learn_structure:[5,1,1,""]},"spnflow.learning.structure.Operation":{CREATE_LEAF:[5,3,1,""],REM_FEATURE:[5,3,1,""],SPLIT_COLS:[5,3,1,""],SPLIT_NAIVE:[5,3,1,""],SPLIT_ROWS:[5,3,1,""]},"spnflow.learning.wrappers":{learn_classifier:[5,1,1,""],learn_estimator:[5,1,1,""]},"spnflow.optimization":{pruning:[7,0,0,"-"]},"spnflow.optimization.pruning":{prune:[7,1,1,""]},"spnflow.structure":{leaf:[8,0,0,"-"],node:[8,0,0,"-"]},"spnflow.structure.leaf":{Bernoulli:[8,2,1,""],Gamma:[8,2,1,""],Gaussian:[8,2,1,""],Isotonic:[8,2,1,""],Leaf:[8,2,1,""],LeafType:[8,2,1,""],Multinomial:[8,2,1,""],Poisson:[8,2,1,""],Uniform:[8,2,1,""]},"spnflow.structure.leaf.Bernoulli":{LEAF_TYPE:[8,3,1,""],fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.leaf.Gamma":{LEAF_TYPE:[8,3,1,""],fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.leaf.Gaussian":{LEAF_TYPE:[8,3,1,""],fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.leaf.Isotonic":{LEAF_TYPE:[8,3,1,""],fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.leaf.Leaf":{fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.leaf.LeafType":{CONTINUOUS:[8,3,1,""],DISCRETE:[8,3,1,""]},"spnflow.structure.leaf.Multinomial":{LEAF_TYPE:[8,3,1,""],fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.leaf.Poisson":{LEAF_TYPE:[8,3,1,""],fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.leaf.Uniform":{LEAF_TYPE:[8,3,1,""],fit:[8,4,1,""],likelihood:[8,4,1,""],log_likelihood:[8,4,1,""],mode:[8,4,1,""],params_count:[8,4,1,""],params_dict:[8,4,1,""],sample:[8,4,1,""]},"spnflow.structure.node":{Mul:[8,2,1,""],Node:[8,2,1,""],Sum:[8,2,1,""],assign_ids:[8,1,1,""],bfs:[8,1,1,""],dfs_post_order:[8,1,1,""]},"spnflow.structure.node.Mul":{likelihood:[8,4,1,""],log_likelihood:[8,4,1,""]},"spnflow.structure.node.Node":{likelihood:[8,4,1,""],log_likelihood:[8,4,1,""]},"spnflow.structure.node.Sum":{likelihood:[8,4,1,""],log_likelihood:[8,4,1,""]},"spnflow.torch":{callbacks:[9,0,0,"-"],constraints:[9,0,0,"-"],layers:[9,0,0,"-"],models:[9,0,0,"-"]},"spnflow.torch.callbacks":{EarlyStopping:[9,2,1,""]},"spnflow.torch.constraints":{ScaleClipper:[9,2,1,""]},"spnflow.torch.constraints.ScaleClipper":{to:[9,4,1,""]},"spnflow.torch.layers":{AutoregressiveLayer:[9,2,1,""],BatchNormLayer:[9,2,1,""],CouplingLayer:[9,2,1,""],GaussianLayer:[9,2,1,""],MaskedLinear:[9,2,1,""],ProductLayer:[9,2,1,""],RootLayer:[9,2,1,""],SumLayer:[9,2,1,""]},"spnflow.torch.layers.AutoregressiveLayer":{forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.layers.BatchNormLayer":{forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.layers.CouplingLayer":{forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.layers.GaussianLayer":{forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.layers.MaskedLinear":{forward:[9,4,1,""],in_features:[9,3,1,""],out_features:[9,3,1,""],weight:[9,3,1,""]},"spnflow.torch.layers.ProductLayer":{forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.layers.RootLayer":{forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.layers.SumLayer":{forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.models":{RatSpn:[9,2,1,""],RatSpnFlow:[9,2,1,""]},"spnflow.torch.models.RatSpn":{constrained_module:[9,4,1,""],forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.torch.models.RatSpnFlow":{constrained_module:[9,4,1,""],forward:[9,4,1,""],training:[9,3,1,""]},"spnflow.utils":{data:[10,0,0,"-"],filter:[10,0,0,"-"],region:[10,0,0,"-"],statistics:[10,0,0,"-"],validity:[10,0,0,"-"]},"spnflow.utils.data":{get_data_domains:[10,1,1,""],ohe_data:[10,1,1,""]},"spnflow.utils.filter":{filter_nodes_type:[10,1,1,""],get_nodes:[10,1,1,""]},"spnflow.utils.region":{RegionGraph:[10,2,1,""]},"spnflow.utils.region.RegionGraph":{make_layers:[10,4,1,""],random_layers:[10,4,1,""]},"spnflow.utils.statistics":{get_depth:[10,1,1,""],get_edges_count:[10,1,1,""],get_parameters_count:[10,1,1,""],get_statistics:[10,1,1,""]},"spnflow.utils.validity":{assert_is_valid:[10,1,1,""],is_complete:[10,1,1,""],is_consistent:[10,1,1,""],is_labeled:[10,1,1,""],is_valid:[10,1,1,""]},spnflow:{algorithms:[3,0,0,"-"],io:[4,0,0,"-"],learning:[5,0,0,"-"],optimization:[7,0,0,"-"],structure:[8,0,0,"-"],torch:[9,0,0,"-"],utils:[10,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","function","Python function"],"2":["py","class","Python class"],"3":["py","attribute","Python attribute"],"4":["py","method","Python method"]},objtypes:{"0":"py:module","1":"py:function","2":"py:class","3":"py:attribute","4":"py:method"},terms:{"abstract":11,"boolean":5,"break":8,"class":[5,8,9,10],"enum":[5,8],"function":[3,5,6,8,10],"new":0,"return":[3,4,5,6,7,8,9,10],"true":[9,10],BFS:8,DFS:8,For:[8,10],One:10,The:[0,3,4,5,6,7,8,9,10],activ:9,acycl:10,addition:3,after:9,algorithm:[0,1,2],all:10,alpha:[6,8],also:[0,3,5,10],altern:10,alwai:10,among:6,ani:10,appropri:[3,5],architectur:0,arrai:6,assert:10,assert_is_valid:10,assign:8,assign_id:8,associ:10,autoregress:[0,9],autoregressivelay:9,base:[5,8,9,10],batch:9,batch_norm:9,batchnormlay:9,been:0,belong:6,bernoulli:8,beta:[6,8],between:10,bfs:8,binari:6,both:0,bottom:3,branch:3,breadth:8,build:0,call:[9,10],callback:[1,2],can:[5,8,10],canon:6,categor:8,cca:6,check:10,child:10,children:[3,8,10],choos:[3,5,6],choose_next_oper:5,chosen:3,class_idx:5,classifi:5,clipper:9,close:10,cluster:6,coeffici:6,col:[2,5],collect:10,column:[5,6],combin:0,complet:10,compos:[5,10],comput:[3,6,8,10],connect:10,consecut:[9,10],consist:10,constrain:9,constrained_modul:9,constraint:[0,1,2],construct:10,contain:[0,8,10],content:[1,11],continu:8,convert:4,copi:9,correctli:10,correl:6,correspond:[6,10],coupl:9,couplinglay:9,create_leaf:5,cross:10,current:9,data:[1,2,5,6,8],decompos:10,deep:0,defin:10,deliv:10,densiti:[0,5,8],depend:6,depth:[8,9,10],deviat:6,devic:9,dfs_post_ord:8,dictionari:[8,10],dinh:0,direct:10,discret:8,disjoint:10,distribut:[0,3,5,6,8,9,10],document:11,doesn:9,domain:[0,5,8,10],domingo:0,done:0,down:3,dropout:9,each:[3,5,6,8,9,10],earli:9,earlystop:9,easi:0,easili:10,edg:10,effici:0,element:[6,10],empti:10,encod:10,end:10,entri:10,epoch:9,epsilon:9,equival:7,estim:[0,3,5],eval_bottom_up:3,eval_top_down:3,evalu:[1,2,8,9],execut:[5,6,8,9],exploit:0,express:0,extens:0,fail:5,fals:[3,9,10],featur:[3,5,6,10,11],file:4,filenam:4,fill:3,filter:[1,2],filter_nodes_typ:10,first:[6,8],fit:8,flag:3,flow:[0,9],follow:[3,10],forward:9,from:[3,4,6,8],func:8,furthermor:10,gamma:8,gaussian:[6,8,9],gaussianlay:9,gener:10,get:[5,6,8,9,10],get_data_domain:10,get_depth:10,get_edges_count:10,get_learn_leaf_method:5,get_nod:10,get_parameters_count:10,get_split_cols_method:6,get_split_rows_method:6,get_statist:10,github:0,give:5,given:[3,5,6,7,8,9,10],gmm:[2,5],graph:10,guarante:0,handl:3,has:10,have:[0,3,5,8],horizont:[5,6],host:0,hot:10,hybrid:0,hyperparamet:5,ids:8,implement:0,improv:9,in_featur:9,in_nod:9,in_partit:9,in_region:9,independ:6,index:[3,5,6,11],indic:[3,5,10],infer:[0,1,2],infinit:3,initi:10,input:[0,3,4,8,9,10],integ:10,intern:3,introduct:11,is_complet:10,is_consist:10,is_first:5,is_label:10,is_valid:10,isoton:[5,8],its:[3,10],job:5,json:[0,1,2],json_obj_spn:4,json_spn_obj:4,kera:9,kmean:[2,5],kwarg:[5,9],label:10,largest:6,latent:6,layer:[0,1,2,10],leaf:[1,2,3,9,10],leaf_func:3,leaf_likelihood:3,leaf_log_likelihood:3,leaf_mp:3,leaf_sampl:3,leaf_typ:8,leaftyp:8,learn:[0,1,2],learn_classifi:5,learn_estim:5,learn_isoton:5,learn_leaf:5,learn_leaf_param:5,learn_ml:5,learn_structur:5,least:[3,10],leav:[3,10],librari:0,like:0,likelihood:[0,3,5,8,9],linear:[6,9],list:[3,5,6,10],load:4,load_json:4,loc:8,local:[5,6],log:[0,3,8,9],log_likelihood:[3,8],logarithm:[3,8],loss:9,lot:0,maf:0,make_lay:10,mask:[0,3,9],maskedlinear:9,maxim:3,maximum:[3,5],mean:8,meta:8,method:[5,6],mid:8,min_cols_slic:5,min_rows_slic:5,minim:7,minimum:5,mix:0,mle:5,mode:8,model:[0,1,2],modifi:8,modul:[1,11],molina:0,momentum:9,move:9,mpe:[1,2],mul:8,multinomi:8,multipl:[0,8,10],multithread:5,must:[3,10],n_batch:9,n_edg:10,n_featur:10,n_flow:9,n_job:5,n_leav:10,n_mul:10,n_node:10,n_param:10,n_repetit:10,n_sum:[9,10],nalisnick:0,nan:3,network:[0,10],neural:0,next:5,node:[1,2,3,4,5,9,10],node_func:3,node_likelihood:3,node_log_likelihood:3,non:[6,10],none:[5,9,10],normal:[0,9],novel:0,ntype:10,number:[3,5,6,8,9,10],nvp:9,obj:4,object:[4,8,9,10],ohe_data:10,one:[3,5],onlin:0,oper:[0,5],optim:[0,1,2],optimize_scal:9,option:5,order:8,origin:6,other:[5,10],otherwis:10,out_channel:9,out_class:9,out_featur:9,out_nod:9,output:[0,3,4,9],over:10,overlap:10,packag:[1,11],page:[0,11],papamakario:0,param:[5,10],paramet:[3,4,5,6,7,8,9,10],params_count:8,params_dict:8,parent:[5,10],partial:6,partit:[6,10],patienc:9,peharz:0,pipelin:6,poisson:8,poon:0,posit:9,possibl:[0,5],post:8,posterior:3,potenti:0,present:0,probabilist:0,procedur:10,product:[0,9,10],productlay:9,properti:[0,9],proport:6,prune:[1,2],put:3,python:0,pytorch:0,rand_stat:[9,10],random:[0,2,5,10],random_col:6,random_lay:10,random_row:6,randomli:[6,10],rat:[0,9],ratspn:9,ratspnflow:9,rdc:[2,5],rdc_cca:6,rdc_col:[5,6],rdc_row:6,rdc_transform:6,real:9,realnvp:0,reason:10,recent:0,refer:11,region:[1,2,9],regiongraph:10,regul:6,relat:11,relu:9,rem_featur:5,repetit:10,replac:3,repositori:11,repres:[3,10],represent:8,requir:5,respect:[5,6],result:[8,9],return_result:3,revers:9,rg_depth:9,rg_repetit:9,root:[3,4,5,7,8,9,10],rootlay:9,row:[2,5],same:[8,10],sampl:[0,1,2,5,6,8],save:4,save_json:4,scale:9,scaleclipp:9,scope:[5,6,8,10],search:[8,11],second:6,serializ:4,set:10,sever:5,should:9,show:0,simplifi:7,sin:6,singl:10,size:[3,6,8],slice:6,some:[0,3,5,6,8,9,10],sort:10,space:6,specif:10,specifi:[9,10],spflow:0,split:[2,5],split_col:[5,6],split_cols_clust:6,split_cols_param:5,split_naiv:5,split_row:[5,6],split_rows_clust:6,split_rows_param:5,spn:[0,3,4,5,7,8,9,10],spnflow:11,standard:6,start:8,statist:[1,2],stdev:8,stop:9,string:[5,6],structur:[0,1,2],sub:3,submodul:[1,2],subpackag:1,subset:10,successfulli:0,sum:[0,3,8,9,10],sum_func:3,sum_mp:3,sum_sampl:3,sumlay:9,support:5,take:10,target:9,task:5,tensor:[0,9],tensorflow:[],test:6,thei:10,theoret:0,thi:[0,3,10],threshold:6,top:3,torch:[1,2],tractabl:0,train:[5,8,9,10],transform:6,treat:0,tupl:[5,10],two:5,type:[8,10],ufunc:6,under:0,uniform:8,union:10,uniqu:10,unit:[0,9],use:[5,6,10],used:0,using:[0,5,6],util:[1,2],valid:[1,2,5,9],valu:[3,5,6,8],variabl:[5,10],vergari:0,version:9,vertic:[5,6],weight:[6,8,9,10],where:[3,5,6],which:[3,9,10],whose:10,width:8,work:0,wrapper:[1,2],zero:10},titles:["SPNFlow","spnflow","spnflow package","spnflow.algorithms package","spnflow.io package","spnflow.learning package","spnflow.learning.splitting package","spnflow.optimization package","spnflow.structure package","spnflow.torch package","spnflow.utils package","Sum-Product Networks and Normalizing Flows for Tractable Density Estimation"],titleterms:{"abstract":0,algorithm:3,callback:9,col:6,constraint:9,content:[2,3,4,5,6,7,8,9,10],data:10,densiti:11,document:0,estim:11,evalu:3,featur:0,filter:10,flow:11,gmm:6,indic:11,infer:3,introduct:0,json:4,kmean:6,layer:9,leaf:[5,8],learn:[5,6],model:9,modul:[2,3,4,5,6,7,8,9,10],mpe:3,network:11,node:8,normal:11,optim:7,packag:[2,3,4,5,6,7,8,9,10],product:11,prune:7,random:6,rdc:6,refer:0,region:10,relat:0,repositori:0,row:6,sampl:3,split:6,spnflow:[0,1,2,3,4,5,6,7,8,9,10],statist:10,structur:[5,8],submodul:[3,4,5,6,7,8,9,10],subpackag:[2,5],sum:11,tabl:11,torch:9,tractabl:11,util:10,valid:10,wrapper:5}})